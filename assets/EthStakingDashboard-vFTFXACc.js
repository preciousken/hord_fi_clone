import{aa as H,d5 as He,d6 as Ie,Z as g,d7 as Se,d8 as I,r as f,j as t,B as L,c as n,p as De,T as z,a3 as Re,f as Ae,I as G,k as Ce,N as s,y as Le,n as C,d9 as _e,da as Me,db as $,a7 as F}from"./index-DrakyAIp.js";import{b as E}from"./cols-DyclnkWh.js";import"./vendor-BosuxZz1.js";const O=e=>({...e,receivedToken:"ETH",sentToken:"",tokenName:"",actionName:"Withdraw ETH",amountReceived:e.totalETHToWithdraw,contract_web3_network_id:H("ETH"),amountSent:"",from:e.user,txHash:e.transaction_hash}),Pe=async()=>(await Se({contractName:"HordETHStakingWithdrawalManager",evtName:"UserWithdrawalCompleted",chainId:H("ETH"),mapEvts:O})??[]).map(O),S=H("ETH"),Ve=async()=>{const e=await I({contractName:"HordETHStakingWithdrawalManager",functionName:"unAllocatedBuffer",chainId:S})||0;return e&&g(e)},We=async()=>{const e=await I({contractName:"HordETHStakingWithdrawalManager",functionName:"assuredClaimsBalance",chainId:S})||0;return e&&g(e)},qe=async()=>{const e=await I({contractName:"HordETHStakingWithdrawalManager",functionName:"totalPendingDebt",chainId:S})||0;return e&&g(e)},Ke=async()=>{const e=await I({contractName:"HordETHStakingWithdrawalManager",functionName:"amountTakenFromBuffer",chainId:S})||0;return e&&g(e)},Be=async e=>{const r=await He("HordETHStakingManager",e),[o,l,c,d,m,p]=await Promise.all([Ie(r,e),Ve(),We(),qe(),Pe(),Ke()]),x=l+o,h=g(m.reduce((w,D)=>+w+ +D.totalETHAfterChargedFee,0));return{totalReserve:x,totalPendingUnassured:d,depositAndRewards:o,buffer:l,totalPendingAssured:c,historic:h,takenFromBuffer:p,poolBalance:o}},N=(e,r)=>e.filter(o=>o.status===r),Ue=32,$e=e=>{const r=N(e,"active_online").length,o=N(e,"active_offline").length,l=N(e,"pending").length,c=N(e,"liquidated").length,d=N(e,"exited").length;return{totalEthValidators:(r+o+l)*Ue,activeValidators:r,pendingValidators:l,inactiveValidators:o,liquidatedValidators:c,exitedValidators:d}},Fe=e=>{const r=e?.[E.UPDATE_REWARDS]?.amount,o=e?.[E.LAUNCH_VALIDATORS]?.amount,l=e?.[E.UPDATE_REWARDS]?.address,c=e?.[E.LAUNCH_VALIDATORS]?.address,d={updateReardsMaintainer:l,launchValidatorsMaintainer:c},m=g(r),p=g(o);return{updateReardsMaintainer:m,launchValidatorsMaintainer:p,maintainerUpdateHash:d.updateReardsMaintainer,maintainerValidatorLauncherHash:d.launchValidatorsMaintainer}},Oe=({record:e,className:r})=>{const{dataSrc:o,loading:l,isProd:c,extraInfo:d}=f.useContext(k),m=e.topRightContent?.render?.(o?.[e.topRightContent.maintainerLink],c);return t.jsxs(L,{type:"neutral-200",className:n("p-4 border-4 flex-1 w-100 h-100",r),children:[t.jsxs("div",{className:"d-flex flex-between gap-2",children:[t.jsxs("div",{className:n("d-flex flex-between flex-center-y gap-2 ",{"w-100":!m}),children:[t.jsx(De,{sm:!0,text:e.title,className:"text-color-secondary font-400 line-height-5"}),t.jsx(z,{text:e.tooltipText,placment:"top",width:200,children:t.jsx(Re,{className:"mt-0-5"})})]}),t.jsx("div",{children:e.topRightContent?.render?.(o?.[e.topRightContent.maintainerLink],c)})]}),t.jsx("div",{className:"font-500 d-flex flex-center-y mt-3",children:t.jsx(Ae,{loading:l,minHeight:"28px",width:"100%",children:t.jsx("div",{className:"d-flex flex-column gap-2",children:e.render?.(o?.[e.dataKey])})})}),!l&&d?.[e?.dataKey]]})},ze=e=>e?.slice(0,6)?.concat("...")?.concat(e.slice(-4));function j({iconName:e="link-dashboard-icon",linkText:r,path:o,isContractLink:l=!1,className:c,isDisabled:d=!1}){const{isProd:m}=f.useContext(k),p=r||(l?ze(o):o),x="https://",h=l?`${x}${m?"/":"/holesky."}etherscan.io/address/${o}`:`${x}${o}`;return t.jsx(z,{show:d,text:"Comming soon",children:t.jsxs("a",{href:h,className:n("dashboard-link px-3 py-2 vdao-bg border-3 d-flex flex-center gap-2 transition",{"link-disabled":d},c),target:"_blank",rel:"noreferrer",children:[t.jsx(G,{name:e}),t.jsx("span",{className:"vdao-text font-500 line-height-4 font-3-5",children:p||"Staking Manager"})]})})}const v=({title:e,titleProps:r,isColumn:o=!1,records:l,styles:c,link:d,className:m,classNameContainer:p})=>{const{contracts:x}=f.useContext(k);return t.jsxs(L,{type:"neutral-100",className:"p-4 w-100 h-100 flex-1",style:{...c},children:[t.jsxs("div",{className:"d-flex flex-center-y flex-between gap-3-5 flex-wrap",children:[t.jsx(Ce,{className:"font-500",style:{...r},children:e}),d&&x&&t.jsxs("div",{className:"d-flex flex-center gap-3 flex-wrap",children:[t.jsx(j,{path:d,iconName:"dashboard-link-icon"}),x.map((h,w)=>t.jsx(j,{isDisabled:!h.address,linkText:h.name,isContractLink:!0,path:h.address},h.name))]})]}),t.jsx("div",{className:n("mt-6 d-flex gap-4 flex-center flex-wrap",{"flex-column":o},p),children:l.map(h=>t.jsx(Oe,{record:h,className:m},h.id))})]})},i="font-5 line-height-7-5 font-500",u=e=>`${e} ETH`,Ge=[{id:"maintainers-update-rewards",tooltipText:"vdao.eth-staking-dashboard.tooltip-maintainers-update-rewards",render:(e=0)=>t.jsx(s,{number:e,formatNumberDisplay:u,className:n(i)}),title:"Stats updater",dataKey:"updateReardsMaintainer",topRightContent:{maintainerLink:"maintainerUpdateHash",render:e=>t.jsx(j,{isContractLink:!0,path:e,className:"ml-auto"})}},{id:"maintainers-launch-validators",tooltipText:"vdao.eth-staking-dashboard.tooltip-maintainers-launch-validators",render:(e=0)=>t.jsx(s,{number:e,formatNumberDisplay:u,className:n(i)}),title:"Validator launcher",dataKey:"launchValidatorsMaintainer",topRightContent:{maintainerLink:"maintainerValidatorLauncherHash",render:e=>t.jsx(j,{isContractLink:!0,path:e,className:"ml-auto"})}}],Je=[{id:"pending-debt",title:"Debt to users (unassured)",tooltipText:"vdao.eth-staking-dashboard.tooltip-pending-eth-unassured",render:(e=0)=>t.jsx(s,{number:e,formatNumberDisplay:u,className:n(i)}),dataKey:"totalPendingUnassured"},{id:"amount-taken-buffer",title:"Debt to DCTLB (buffer)",tooltipText:"vdao.eth-staking-dashboard.tooltip-amount-taken-from-buffer",render:(e=0)=>t.jsx(s,{number:e,formatNumberDisplay:u,className:n(i)}),dataKey:"takenFromBuffer"},{id:"liquidated-eth",title:"Liquidated ETH (queued)",tooltipText:"The amount of ETH that will shortly arrive to the pool, due to validators that have been recently exited",render:(e=0)=>t.jsx(s,{number:e,formatNumberDisplay:u,className:n(i)}),dataKey:"liquidatedEth"},{id:"totla-pool-balance",title:"Total ETH in pool",tooltipText:"The total amount of ETH in our pool, including ETH locked in validators, user deposits and partial withdrawals This does not include assured debt",render:(e=0)=>t.jsx(s,{number:e,formatNumberDisplay:u,className:n(i)}),dataKey:"totalEthInPool"},{id:"total-reserves",title:"Total reserves",tooltipText:"vdao.eth-staking-dashboard.tooltip-total-eth-in-reserves",render:(e=0)=>t.jsx(s,{number:e,formatNumberDisplay:u,className:n(i)}),dataKey:"totalReserve"}],Qe=[{id:"deposit-and-rewards",title:"Deposits & rewards",tooltipText:"ETH held in reserves from user deposits, as well as some of the rewards (partial withdrawals and execution rewards)",render:(e=0)=>t.jsx(s,{number:e,formatNumberDisplay:u,className:n(i)}),dataKey:"depositAndRewards"},{id:"buffer",tooltipText:"vdao.eth-staking-dashboard.tooltip-buffer",title:"vdao.eth-staking-dashboard.buffer",render:(e=0)=>t.jsx(s,{number:e,formatNumberDisplay:u,className:n(i)}),dataKey:"buffer"},{id:"total-validators",tooltipText:"vdao.eth-staking-dashboard.tooltip-total-eth-in-validators",render:(e=0)=>t.jsxs("div",{className:"d-flex flex-center gap-2",children:[t.jsx(s,{number:e,formatNumberDisplay:u,className:n(i,"text-secondary")}),t.jsx(G,{name:"lock-icon-dashboard",width:20,height:20})]}),title:"Locked in validators",dataKey:"totalEthValidators"}],Ze=[{id:"pending-assured",tooltipText:"vdao.eth-staking-dashboard.tooltip-pending-eth-assured",title:"vdao.eth-staking-dashboard.pending-eth-assured",render:(e=0)=>t.jsx(s,{number:e,formatNumberDisplay:u,className:n(i)}),dataKey:"totalPendingAssured"},{id:"pending-unassured",tooltipText:"vdao.eth-staking-dashboard.tooltip-pending-eth-unassured",title:"vdao.eth-staking-dashboard.pending-eth-unassured",render:(e=0)=>t.jsx(s,{number:e,formatNumberDisplay:u,className:n(i)}),dataKey:"totalPendingUnassured"},{id:"historic-success-withdrawals",tooltipText:"vdao.eth-staking-dashboard.tooltip-historic-success-withdrawals",title:"Total withdrawals to-date",render:(e=0)=>t.jsx(s,{number:e,formatNumberDisplay:u,className:n(i)}),dataKey:"historic"}],Xe=[{id:"active-validators",tooltipText:"vdao.eth-staking-dashboard.tooltip-active-validators",render:(e=0)=>t.jsx(s,{number:e,className:n(i)}),title:"Active",dataKey:"activeValidators"},{id:"pending-validators",tooltipText:"vdao.eth-staking-dashboard.tooltip-pending-validators",render:(e=0)=>t.jsx(s,{number:e,className:n(i)}),title:"Pending",dataKey:"pendingValidators"},{id:"inactive-validators",tooltipText:"vdao.eth-staking-dashboard.tooltip-inactive-validators",render:(e=0)=>t.jsx(s,{number:e,className:n(i)}),title:"Inactive",dataKey:"inactiveValidators"},{id:"exited-validators",tooltipText:"Number of validators that have been exited but not fully liquidated yet",render:(e=0)=>t.jsx(s,{number:e,className:n(i)}),title:"Exited",dataKey:"exitedValidators"},{id:"liquidated",tooltipText:"Number of validators that have been exited and fully liquidated",render:(e=0)=>t.jsx(s,{number:e,className:n(i)}),title:"Liquidated",dataKey:"liquidatedValidators"}],Ye=[{id:"latest-epoch",tooltipText:"vdao.eth-staking-dashboard.tooltip-revenue-latest-epoch",render:(e="")=>t.jsx("span",{className:i,children:e}),title:"Latest Epoch",dataKey:"latestEpoch"},{id:"airdrop-amount",tooltipText:"vdao.eth-staking-dashboard.tooltip-revenue-airdrop-amount",render:(e=0)=>t.jsx(s,{number:e,decimals:5,className:n(i),formatNumberDisplay:r=>`${r} hETH`}),title:"Airdrop Amount",dataKey:"airdropAmount"},{id:"enrolled-hord",tooltipText:"vdao.eth-staking-dashboard.tooltip-revenue-enrolled-hord",render:(e=0)=>t.jsx(s,{number:e,className:n(i)}),title:"Enrolled HORD",dataKey:"enrolledHord"},{id:"enrolled-wallets",tooltipText:"vdao.eth-staking-dashboard.tooltip-revenue-enrolled-wallets",render:(e=0)=>t.jsx(s,{number:e,className:n(i)}),title:"Enrolled Wallets",dataKey:"enrolledWallets"}],et=()=>{const e={fontSize:"16px",lineHeight:"24px"};return t.jsxs("div",{className:"d-flex flex-column flex-center gap-6 w-100",children:[t.jsxs("div",{className:"d-flex flex-center gap-6 w-100 h-100 reserves-withdrawals-section",children:[t.jsx(v,{isColumn:!0,title:"Reserves",records:Qe,titleProps:e}),t.jsx(v,{isColumn:!0,title:"Withdrawals",records:Ze,titleProps:e})]}),t.jsx(v,{title:"Validators",records:Xe,titleProps:e}),t.jsx(v,{title:"Latest Revenue Share Epoch",records:Ye,titleProps:e})]})};function tt(){return t.jsx(v,{records:Ge,title:"Maintainers",titleProps:{fontSize:"18px",lineHeight:"28px"}})}const at=()=>{const{enviromentTitle:e,evirometnLink:r}=f.useContext(k);return t.jsx(v,{isColumn:!1,records:Je,link:r,styles:{marginTop:"40px",border:"1px solid var(--vdao-color)"},title:e,titleProps:{fontSize:"24px",lineHeight:"32px"},className:"enviroment-card",classNameContainer:"enviroment-container"})},st=()=>t.jsxs("div",{className:"d-flex flex-column gap-10",children:[t.jsx(at,{}),t.jsx(et,{}),t.jsx(tt,{})]}),k=f.createContext({contracts:[],enviromentTitle:"",evirometnLink:"",dataSrc:null,loading:!1,isProd:!1,extraInfo:null}),nt=()=>{const{hethInfo:{latestHethStat:e,isLoading:r},validatorsInfo:{validators:o,isLoading:l},lidoTokens:c,loadingLidoTokens:d,withdrawals:m,loadingWithdrawals:p,config:x}=Le(a=>({hethInfo:a.ethStaking.hethInfo,lidoTokens:a.ethStaking.lidoTokens.tokens,loadingLidoTokens:a.ethStaking.lidoTokens.loading,withdrawals:a.ethStaking.allWithdrawals.withdrawals,loadingWithdrawals:a.ethStaking.allWithdrawals.loading,validatorsInfo:a.ethStaking.validatorsInfo,config:a.general.config})),{epoch_details:{airdrop_amount:h,epoch_name:w,total_pool_hord_balance:D,registered_epoch_user_count:J},loading:Q}=x,_=c?.find(a=>a.token_symbol==="stETH"),M=c?.find(a=>a.token_symbol==="wstETH"),Z=_?.token_address,X=M?.token_address,b=H("ETH"),{data:P,isLoading:R}=C({queryKey:["fetchContractAddresses"],queryFn:_e}),{data:y={},isLoading:Y}=C({queryKey:["dashboardInfo"],queryFn:()=>Be(b)}),{data:ee={},isLoading:te}=C({queryKey:["maintainers"],queryFn:Me}),A=P?.HordETHStakingManager?.networks[b]?.Proxy,ae=P?.HordETHStakingWithdrawalManager?.networks[b]?.Proxy,se=[{name:"Staking Manager",address:`${A}`},{name:"Withdrawal Manager",address:`${ae}`}],ne={develop:"Develop (Test)",staging:"Staging",master:"Production"},oe={develop:"test-app.hord.fi",staging:"staging-app.hord.fi",master:"app.hord.fi"},re=f.useMemo(()=>$e(o),[o.length]),ie=Fe(ee),[de,le]=f.useState(0),[ce,he]=f.useState(0),[ue,V]=f.useState(!1),me=async()=>{V(!0);try{const[a,U]=await Promise.all([$(A,Z,b),$(A,X,b)]);a&&le(+a),U&&he(+U)}catch(a){throw a(a)}finally{V(!1)}};f.useEffect(()=>{!d&&!R&&me()},[d,R]);const pe=R||l||Q||te||r||Y||d||ue||p,W=g(+de),q=g(+ce),fe=W*_?.lsd_price_eth||0,xe=q*M?.lsd_price_eth||0,ge=y?.poolBalance,T="white-space-no-wrap text-secondary font-3-5 line-height-5",K=e?.queued_eth_for_exit,be=y?.totalPendingUnassured,ve=y?.takenFromBuffer,B=Math.min(K||0,be||0),Te=(K||0)-B,Ne=Math.min(Te,ve||0),ke={depositAndRewards:t.jsxs("div",{className:"d-flex flex-center-y flex-between gap-2 mt-2",style:{height:"20px"},children:[t.jsx(s,{number:ge,formatNumberDisplay:a=>`${a} ETH`,className:T,decimals:4}),t.jsx("div",{className:"vertical-separator"}),t.jsx(s,{number:W,formatNumberDisplay:a=>`${a} stETH`,className:T,decimals:4}),t.jsx("div",{className:"vertical-separator"}),t.jsx(s,{number:q,formatNumberDisplay:a=>`${a} wstETH`,className:T,decimals:4})]}),historic:t.jsx("div",{className:"mt-2",children:t.jsxs("span",{className:"text-secondary font-3-5 line-height-5",children:[m?.length," total withdrawals"]})}),totalPendingUnassured:t.jsx("div",{className:"mt-2",children:t.jsx(s,{number:B,formatNumberDisplay:a=>`${a} ETH queued`,className:T,decimals:4})}),takenFromBuffer:t.jsx("div",{className:"mt-2",children:t.jsx(s,{number:Ne,formatNumberDisplay:a=>`${a} ETH queued`,className:T,decimals:4})}),liquidatedEth:t.jsx("div",{className:"liquidated-container"})},{depositAndRewards:we,...ye}=y,Ee={...re,...ie,...ye,depositAndRewards:we+fe+xe,totalEthInPool:e?.total_pool_balance,liquidatedEth:e?.queued_eth_for_exit,latestEpoch:w||"No Name",airdropAmount:h,enrolledHord:D,enrolledWallets:J},je={contracts:se,dataSrc:Ee,evirometnLink:oe[F?.stage],extraInfo:ke,isProd:b===1,loading:pe,enviromentTitle:ne[F.stage]};return t.jsx(k.Provider,{value:je,children:t.jsx(st,{})})},ot=nt;function lt(){return t.jsx("div",{className:"container dashboard-container",children:t.jsx(L,{className:"eth-staking-dashboard-wrapper",children:t.jsx(ot,{})})})}export{lt as default};